<!DOCTYPE html>
<html lang="{{ g.get('lang', 'pt') }}">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, maximum-scale=1, initial-scale=1" />
  <title>{% block title %}Superdegen{% endblock %}</title>

  <!-- Fonte Inter + Inter Tight -->
  <link href="https://fonts.googleapis.com/css2?family=Inter+Tight:wght@400;500;600&family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">

  <script>
    const saved = localStorage.getItem("superdegen-theme") || "dark";
    document.documentElement.dataset.theme = saved;
  </script>

  <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
  {% block head_extra %}{% endblock %}
</head>

<body data-page="{{ page|default('general') }}" class="app-body {% if page == 'chat' %}no-nav{% endif %}">

{% if g.user %}
<script>
  window.currentUserId = {{ g.user.id }};
</script>
{% endif %}

  <!-- NAV SUPERIOR -->
  <nav class="navbar">
    <div class="logo">
      <a href="{{ url_for('home.home_page') }}">superdegen</a>
    </div>

    {% if g.user %}
    <div class="nav-icons">
      <a href="{{ url_for('notifications.notifications_home') }}" class="nav-bell">
        <img src="{{ url_for('static', filename='icons/notifications.svg') }}" alt="">
        <span id="notif-badge"></span>
      </a>


      <a href="{{ url_for('chat.chat_list') }}" class="nav-chat">
        <img src="{{ url_for('static', filename='icons/chat.svg') }}" alt="{{ _('Chat') }}">
        <span id="chat-badge"></span>
      </a>


      <button id="menu-button" class="icon-btn">
        <img src="{{ url_for('static', filename='icons/menu.svg') }}" alt="{{ _('Menu') }}">
      </button>
    </div>
    {% endif %}
  </nav>

  <!-- CONTEÚDO -->
  <main class="content">
    {% block content %}{% endblock %}
  </main>

  {% if g.user %}
  <!-- NAV INFERIOR -->
  <nav class="bottom-nav">
    <a href="{{ url_for('home.home_page') }}" class="bn-item" data-path="/">
      <img src="{{ url_for('static', filename='icons/home.svg') }}" alt="{{ _('Home') }}">
    </a>

    <a href="{{ url_for('search.search_home') }}" class="bn-item" data-path="/search">
      <img src="{{ url_for('static', filename='icons/search.svg') }}" alt="{{ _('Buscar') }}">
    </a>

    <button id="action-button" class="bn-item add-btn">
      <img src="{{ url_for('static', filename='icons/add.svg') }}" alt="{{ _('Adicionar') }}">
    </button>

    <a href="{{ url_for('matches.matches_home') }}" class="bn-item" data-path="/matches">
      <img src="{{ url_for('static', filename='icons/matches.svg') }}" alt="{{ _('Partidas') }}">
    </a>

    <a href="{{ url_for('profile.profile_home') }}" class="bn-item" data-path="/profile">
      <img src="{{ url_for('static', filename='icons/profile.svg') }}" alt="{{ _('Perfil') }}">
    </a>
  </nav>
  {% endif %}

{% block modals %}

<!-- MODAL: Criar Partida -->
<div id="modal-create-match" class="modal-backdrop">
  <div class="modal-card">
    <h3>{{ _("Registrar nova partida") }}</h3>

    <div class="modal-row">
      <div class="modal-field">
        <label for="match-title-input" class="modal-label">{{ _("Título") }}</label>
        <input type="text" id="match-title-input" class="modal-input" placeholder="{{ _('Ex: Superdegen vs Rivais') }}">
      </div>
      <div class="modal-field">
        <label for="match-opponents-input" class="modal-label">{{ _("Adversários") }}</label>
        <input type="text" id="match-opponents-input" class="modal-input" placeholder="{{ _('Time A x Time B') }}">
      </div>
    </div>

    <div class="modal-row two-columns">
      <div class="modal-field">
        <label for="match-game-input" class="modal-label">{{ _("Jogo") }}</label>
        <input type="text" id="match-game-input" class="modal-input" placeholder="{{ _('Jogo ou modalidade') }}">
      </div>
      <div class="modal-field">
        <label for="match-league-input" class="modal-label">{{ _("Liga/Torneio") }}</label>
        <input type="text" id="match-league-input" class="modal-input" placeholder="{{ _('Nome da competição') }}">
      </div>
    </div>

    <div class="modal-row two-columns">
      <div class="modal-field">
        <label for="match-stage-input" class="modal-label">{{ _("Fase") }}</label>
        <input type="text" id="match-stage-input" class="modal-input" placeholder="{{ _('Fase de grupos, final...') }}">
      </div>
      <div class="modal-field">
        <label for="match-status-select" class="modal-label">{{ _("Status") }}</label>
        <select id="match-status-select" class="modal-select">
          <option value="scheduled">{{ _("Agendado") }}</option>
          <option value="live">{{ _("Ao vivo") }}</option>
          <option value="finished">{{ _("Finalizado") }}</option>
        </select>
      </div>
    </div>

    <div class="modal-row">
      <div class="modal-field">
        <label for="match-date-input" class="modal-label">{{ _("Data e horário") }}</label>
        <input type="datetime-local" id="match-date-input" class="modal-input">
      </div>
    </div>

    <button id="confirm-create-match" class="modal-action">
      {{ _("Salvar partida") }}
    </button>

    <button class="close-btn" data-close>{{ _("Fechar") }}</button>
  </div>
</div>

<!-- MODAL: Atualizar Resultado -->
<div id="modal-update-result" class="modal-backdrop">
  <div class="modal-card">
    <h3>{{ _("Atualizar resultado") }}</h3>

    <div class="modal-row two-columns">
      <div class="modal-field">
        <label for="result-status-select" class="modal-label">{{ _("Status") }}</label>
        <select id="result-status-select" class="modal-select">
          <option value="scheduled">{{ _("Agendado") }}</option>
          <option value="live">{{ _("Ao vivo") }}</option>
          <option value="finished">{{ _("Finalizado") }}</option>
        </select>
      </div>
      <div class="modal-field">
        <label for="result-score-input" class="modal-label">{{ _("Resultado") }}</label>
        <input type="text" id="result-score-input" class="modal-input" placeholder="{{ _('2x1, 3-0...') }}">
      </div>
    </div>

    <div class="modal-row">
      <div class="modal-field">
        <label for="result-summary-input" class="modal-label">{{ _("Resumo da partida") }}</label>
        <textarea id="result-summary-input" class="modal-textarea" placeholder="{{ _('Detalhes, destaques e narrativa da partida') }}"></textarea>
      </div>
    </div>

    <button id="confirm-update-result" class="modal-action">
      {{ _("Atualizar") }}
    </button>

    <button class="close-btn" data-close>{{ _("Cancelar") }}</button>
  </div>
</div>

{% endblock %}

<!-- SIDE MENU BACKDROP -->
<div id="side-menu-backdrop"></div>

<!-- SIDE MENU (NÍVEL 1) -->
<div id="side-menu">
  <div class="side-menu-item" id="open-preferences">{{ _("Preferências") }}</div>
  <a class="side-menu-item" href="{{ url_for('profile.profile_home') }}">{{ _("Meu Perfil") }}</a>
  <a class="side-menu-item" href="{{ url_for('auth.logout') }}">
    <img src="{{ url_for('static', filename='icons/logout.svg') }}" alt="">
    <span>{{ _("Sair") }}</span>
  </a>
</div>

<!-- SIDE MENU (NÍVEL 2 — PREFERÊNCIAS) -->
<div id="side-submenu">
  <div class="side-menu-back" id="close-submenu">← {{ _("Voltar") }}</div>
  <div class="side-menu-item" id="toggle-theme">{{ _("Mudar Tema") }}</div>
  <div class="side-menu-item disabled">{{ _("Idioma (em breve)") }}</div>
</div>

<script type="module" src="{{ url_for('static', filename='js/main.js') }}"></script>

{% block scripts %}{% endblock %}

</body>
</html>
